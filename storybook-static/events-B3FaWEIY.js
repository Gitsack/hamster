import{j as e}from"./jsx-runtime-u17CrQMm.js";import{t as p,H as y}from"./app-CFoDCqX-.js";import{A as v}from"./app-layout-CTvh2ZE0.js";import{B as g}from"./button-B9kPMW4q.js";import{B as h}from"./badge-B6bn15vN.js";import{C as N,a as w,b as T,d as b}from"./card-BT9UEfea.js";import{S as H}from"./skeleton-A7behTLO.js";import{T as C,a as E,b as u,c as l,d as S,e as d}from"./table-B1mxUS1v.js";import{H as A,u as R}from"./index.min-fvaCWwiU.js";import{r as i}from"./app-BHuVDAkc.js";import"./preload-helper-PPVm8Dsz.js";import"./client-Bx265bNG.js";import"./index-CYxWbFTv.js";import"./index-D5-0xbEa.js";import"./utils-CDN07tui.js";import"./dialog-CQTA4pg1.js";import"./createLucideIcon-GXN1tXoc.js";import"./spinner-McTJFRVv.js";import"./media-status-badge-DETbNkVM.js";import"./useRenderElement-D0Q1kVud.js";import"./useBaseUiId-BvJSLVy2.js";import"./useValueAsRef-GoV-SdOe.js";import"./media-teaser-CTZEtwns.js";import"./check-BEKQ83Eb.js";import"./useLabelableId-CyGgmgle.js";import"./valueToPercent-CmxdyyhM.js";import"./slot-CUYGZ4Fv.js";import"./hamster-icon-DOXrnfMg.js";import"./input-Bw95PIWX.js";function B(a){if(!a)return"-";const m=new Date(a),o=new Date().getTime()-m.getTime(),t=Math.floor(o/6e4);if(t<1)return"just now";if(t<60)return`${t}m ago`;const r=Math.floor(t/60);return r<24?`${r}h ago`:`${Math.floor(r/24)}d ago`}function D(){const[a,m]=i.useState([]),[x,o]=i.useState(!0),[t,r]=i.useState(!1),n=i.useCallback(async(s=!0)=>{s&&o(!0);try{const c=await fetch("/api/v1/notifications/history?limit=50");if(c.ok){const f=await c.json();m(Array.isArray(f)?f:f.data??[])}}catch{p.error("Failed to fetch events")}finally{o(!1)}},[]);i.useEffect(()=>{n()},[n]);const j=async()=>{r(!0),await n(!1),r(!1),p.success("Events refreshed")};return e.jsxs(v,{title:"Events",actions:e.jsxs(g,{onClick:j,disabled:t,children:[e.jsx(A,{icon:R,className:`h-4 w-4 mr-2 ${t?"animate-spin":""}`}),"Refresh"]}),children:[e.jsx(y,{title:"Events"}),e.jsxs(N,{children:[e.jsx(w,{children:e.jsx(T,{children:"Notification History"})}),e.jsx(b,{children:x?e.jsx("div",{className:"space-y-3",children:Array.from({length:5}).map((s,c)=>e.jsx(H,{className:"h-10 w-full"},c))}):a.length===0?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No events yet."}):e.jsx("div",{className:"overflow-x-auto -mx-6 px-6",children:e.jsxs(C,{children:[e.jsx(E,{children:e.jsxs(u,{children:[e.jsx(l,{children:"Provider"}),e.jsx(l,{className:"w-36",children:"Event"}),e.jsx(l,{className:"w-24",children:"Status"}),e.jsx(l,{className:"w-36",children:"Time"})]})}),e.jsx(S,{children:a.map(s=>e.jsxs(u,{children:[e.jsxs(d,{children:[e.jsx("div",{className:"font-medium",children:s.providerName}),s.error&&e.jsx("div",{className:"text-xs text-destructive mt-0.5 truncate max-w-md",children:s.error})]}),e.jsx(d,{children:e.jsx(h,{variant:"outline",className:"text-xs",children:s.eventType})}),e.jsx(d,{children:s.success?e.jsx(h,{className:"bg-green-500",children:"Sent"}):e.jsx(h,{className:"bg-red-500",children:"Failed"})}),e.jsx(d,{className:"text-muted-foreground text-sm",children:B(s.sentAt)})]},s.id))})]})})})]})]})}D.__docgenInfo={description:"",methods:[],displayName:"SystemEvents"};export{D as default};
