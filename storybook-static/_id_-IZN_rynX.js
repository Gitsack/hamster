import{j as e}from"./jsx-runtime-u17CrQMm.js";import{f as L,t as x,H as y,L as v}from"./app-CFoDCqX-.js";import{A as S}from"./app-layout-CTvh2ZE0.js";import{B as h}from"./button-B9kPMW4q.js";import{B as u}from"./badge-B6bn15vN.js";import{C as o,d as j,a as z,b as I}from"./card-BT9UEfea.js";import{S as f}from"./skeleton-A7behTLO.js";import{T as M,a as q,b as T,c as r,d as _,e as t}from"./table-B1mxUS1v.js";import{H as n,i as E,A as G,G as U,n as P,u as K}from"./index.min-fvaCWwiU.js";import{S as p}from"./spinner-McTJFRVv.js";import{r as l}from"./app-BHuVDAkc.js";import"./preload-helper-PPVm8Dsz.js";import"./client-Bx265bNG.js";import"./index-CYxWbFTv.js";import"./index-D5-0xbEa.js";import"./utils-CDN07tui.js";import"./dialog-CQTA4pg1.js";import"./createLucideIcon-GXN1tXoc.js";import"./media-status-badge-DETbNkVM.js";import"./useRenderElement-D0Q1kVud.js";import"./useBaseUiId-BvJSLVy2.js";import"./useValueAsRef-GoV-SdOe.js";import"./media-teaser-CTZEtwns.js";import"./check-BEKQ83Eb.js";import"./useLabelableId-CyGgmgle.js";import"./valueToPercent-CmxdyyhM.js";import"./slot-CUYGZ4Fv.js";import"./hamster-icon-DOXrnfMg.js";import"./input-Bw95PIWX.js";function Q(){const{url:C}=L(),d=C.split("/").pop(),[a,F]=l.useState(null),[c,k]=l.useState([]),[B,R]=l.useState(!0),[m,g]=l.useState(!1),[N,w]=l.useState(null);l.useEffect(()=>{$()},[d]);const $=async()=>{try{const s=await fetch(`/api/v1/albums/${d}`);if(s.ok){const i=await s.json();F(i),b()}}catch(s){console.error("Failed to fetch album:",s)}finally{R(!1)}},b=async()=>{g(!0);try{const s=await fetch(`/api/v1/albums/${d}/releases`);if(s.ok){const i=await s.json();k(i)}}catch(s){console.error("Failed to search:",s),x.error("Search failed")}finally{g(!1)}},D=async s=>{w(s.id);try{x.info("Download client integration coming soon")}catch(i){console.error("Failed to grab release:",i),x.error("Failed to grab release")}finally{w(null)}},H=s=>s>=1073741824?`${(s/1073741824).toFixed(1)} GB`:s>=1048576?`${(s/1048576).toFixed(0)} MB`:`${(s/1024).toFixed(0)} KB`,A=s=>new Date(s).toLocaleDateString(void 0,{year:"numeric",month:"short",day:"numeric"});return B?e.jsxs(S,{title:"Loading...",children:[e.jsx(y,{title:"Loading..."}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx(f,{className:"h-24 w-24 rounded-lg"}),e.jsxs("div",{className:"flex-1 space-y-4",children:[e.jsx(f,{className:"h-6 w-1/3"}),e.jsx(f,{className:"h-4 w-1/4"})]})]})})]}):e.jsxs(S,{title:"Manual Search",actions:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(h,{variant:"outline",asChild:!0,children:e.jsxs(v,{href:"/requests",children:[e.jsx(n,{icon:P,className:"h-4 w-4 mr-2"}),"Back to Requests"]})}),e.jsx(h,{onClick:b,disabled:m,children:m?e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"mr-2"}),"Searching..."]}):e.jsxs(e.Fragment,{children:[e.jsx(n,{icon:K,className:"h-4 w-4 mr-2"}),"Re-search"]})})]}),children:[e.jsx(y,{title:a?`Search: ${a.title}`:"Manual Search"}),e.jsxs("div",{className:"space-y-6",children:[a&&e.jsx(o,{children:e.jsxs(j,{className:"flex items-center gap-4 p-4",children:[e.jsx("div",{className:"h-24 w-24 rounded bg-muted overflow-hidden flex-shrink-0",children:a.imageUrl?e.jsx("img",{src:a.imageUrl,alt:a.title,className:"w-full h-full object-cover"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsx(n,{icon:E,className:"h-10 w-10 text-muted-foreground/50"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h2",{className:"text-xl font-bold",children:a.title}),e.jsx(v,{href:`/artist/${a.artistId}`,className:"text-muted-foreground hover:text-primary transition-colors",children:a.artistName}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[a.releaseDate&&e.jsx(u,{variant:"outline",children:a.releaseDate.split("-")[0]}),e.jsx(u,{className:"capitalize",children:a.albumType})]})]})]})}),m?e.jsx(o,{children:e.jsx(j,{className:"py-12",children:e.jsxs("div",{className:"flex flex-col items-center gap-4",children:[e.jsx(p,{className:"size-8 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"Searching indexers..."})]})})}):c.length===0?e.jsx(o,{children:e.jsxs(j,{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx("div",{className:"rounded-full bg-muted p-6 mb-4",children:e.jsx(n,{icon:G,className:"h-12 w-12 text-muted-foreground"})}),e.jsx("h3",{className:"text-lg font-medium mb-2",children:"No releases found"}),e.jsx("p",{className:"text-muted-foreground",children:"No releases found on your configured indexers. Try again later or check your indexer settings."})]})}):e.jsxs(o,{children:[e.jsx(z,{children:e.jsxs(I,{className:"text-base",children:[c.length," Release",c.length!==1&&"s"," Found"]})}),e.jsxs(M,{children:[e.jsx(q,{children:e.jsxs(T,{children:[e.jsx(r,{children:"Release"}),e.jsx(r,{className:"w-32",children:"Indexer"}),e.jsx(r,{className:"w-24",children:"Quality"}),e.jsx(r,{className:"w-24 text-right",children:"Size"}),e.jsx(r,{className:"w-24 text-right",children:"Grabs"}),e.jsx(r,{className:"w-32",children:"Age"}),e.jsx(r,{className:"w-24"})]})}),e.jsx(_,{children:c.map(s=>e.jsxs(T,{children:[e.jsx(t,{children:e.jsxs("div",{className:"max-w-md",children:[e.jsx("p",{className:"font-medium truncate",title:s.title,children:s.title}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.protocol==="usenet"?"Usenet":"Torrent",s.source==="prowlarr"&&" (via Prowlarr)"]})]})}),e.jsx(t,{className:"text-muted-foreground",children:s.indexer}),e.jsx(t,{children:s.quality?e.jsx(u,{variant:"outline",children:s.quality}):e.jsx("span",{className:"text-muted-foreground",children:"-"})}),e.jsx(t,{className:"text-right text-muted-foreground",children:H(s.size)}),e.jsx(t,{className:"text-right text-muted-foreground",children:s.grabs??s.seeders??"-"}),e.jsx(t,{className:"text-muted-foreground",children:A(s.publishDate)}),e.jsx(t,{children:e.jsx(h,{size:"sm",onClick:()=>D(s),disabled:N===s.id,children:N===s.id?e.jsx(p,{}):e.jsx(n,{icon:U,className:"h-4 w-4"})})})]},`${s.id}-${s.indexerId}`))})]})]})]})]})}Q.__docgenInfo={description:"",methods:[],displayName:"ManualSearch"};export{Q as default};
