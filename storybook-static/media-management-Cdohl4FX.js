import{j as e}from"./jsx-runtime-u17CrQMm.js";import{H as Kt,S as tt,a as st,c as nt,d as o,b as Bt,e as V,C as Lt,t as c}from"./app-CFoDCqX-.js";import{r as a}from"./app-BHuVDAkc.js";import{A as Ht}from"./app-layout-CTvh2ZE0.js";import{B as N}from"./button-B9kPMW4q.js";import{C as je,a as ve,b as ye,c as be,d as Ne}from"./card-BT9UEfea.js";import{D as te,a as se,b as ne,c as ae,d as ie,e as re}from"./dialog-CQTA4pg1.js";import{I as le}from"./input-Bw95PIWX.js";import{S as oe}from"./switch-FMiJ_scT.js";import{B as Ut}from"./badge-B6bn15vN.js";import{c as Re}from"./utils-CDN07tui.js";import{H as S,T as qt,ac as $t,a0 as _e,a9 as Me,O as Qt,I as ut,y as Wt,z as Jt,e as Vt,Q as Gt,x as Zt,a5 as at,w as it,l as Yt,M as rt,a1 as lt}from"./index.min-fvaCWwiU.js";import{e as Xt,u as Ee,c as mt,d as es,n as ts}from"./useBaseUiId-BvJSLVy2.js";import{a as G,f as ss,u as ns,c as ze}from"./useRenderElement-D0Q1kVud.js";import{d as as,c as is}from"./useLabelableId-CyGgmgle.js";import{J as rs,aw as ls,ax as ot,h as os,Z as B,a4 as ds,L as ht,K as cs}from"./media-status-badge-DETbNkVM.js";import{F as us}from"./folder-browser-szzA91qX.js";import"./preload-helper-PPVm8Dsz.js";import"./client-Bx265bNG.js";import"./index-CYxWbFTv.js";import"./index-D5-0xbEa.js";import"./skeleton-A7behTLO.js";import"./spinner-McTJFRVv.js";import"./createLucideIcon-GXN1tXoc.js";import"./media-teaser-CTZEtwns.js";import"./check-BEKQ83Eb.js";import"./useValueAsRef-GoV-SdOe.js";import"./valueToPercent-CmxdyyhM.js";import"./slot-CUYGZ4Fv.js";import"./hamster-icon-DOXrnfMg.js";function ms(n){const{open:l,defaultOpen:p,onOpenChange:q,disabled:R}=n,P=l!==void 0,[k,F]=as({controlled:l,default:p,name:"Collapsible",state:"open"}),{mounted:A,setMounted:v,transitionStatus:f}=rs(k,!0,!0),[m,x]=a.useState(k),[{height:y,width:C},E]=a.useState({height:void 0,width:void 0}),I=Xt(),[_,M]=a.useState(),Q=_??I,[O,W]=a.useState(!1),[T,L]=a.useState(!1),H=a.useRef(null),w=a.useRef(null),J=a.useRef(null),z=a.useRef(null),i=ls(z,!1),j=Ee(g=>{const d=!k,b=mt(es,g.nativeEvent);if(q(d,b),b.isCanceled)return;const K=z.current;w.current==="css-animation"&&K!=null&&K.style.removeProperty("animation-name"),!O&&!T&&(w.current!=null&&w.current!=="css-animation"&&!A&&d&&v(!0),w.current==="css-animation"&&(!m&&d&&x(!0),!A&&d&&v(!0))),F(d),w.current==="none"&&A&&!d&&v(!1)});return G(()=>{P&&w.current==="none"&&!T&&!k&&v(!1)},[P,T,k,l,v]),a.useMemo(()=>({abortControllerRef:H,animationTypeRef:w,disabled:R,handleTrigger:j,height:y,mounted:A,open:k,panelId:Q,panelRef:z,runOnceAnimationsFinish:i,setDimensions:E,setHiddenUntilFound:W,setKeepMounted:L,setMounted:v,setOpen:F,setPanelIdState:M,setVisible:x,transitionDimensionRef:J,transitionStatus:f,visible:m,width:C}),[H,w,R,j,y,A,k,Q,z,i,E,W,L,v,F,x,J,f,m,C])}const pt=a.createContext(void 0);function ft(){const n=a.useContext(pt);if(n===void 0)throw new Error(ss(15));return n}let de=(function(n){return n.open="data-open",n.closed="data-closed",n[n.startingStyle=ot.startingStyle]="startingStyle",n[n.endingStyle=ot.endingStyle]="endingStyle",n})({}),hs=(function(n){return n.panelOpen="data-panel-open",n})({});const ps={[de.open]:""},fs={[de.closed]:""},gs={open(n){return n?{[hs.panelOpen]:""}:null}},xs={open(n){return n?ps:fs}};let js=(function(n){return n.disabled="data-disabled",n.orientation="data-orientation",n})({});function vs(n){const{abortControllerRef:l,animationTypeRef:p,externalRef:q,height:R,hiddenUntilFound:P,keepMounted:k,id:F,mounted:A,onOpenChange:v,open:f,panelRef:m,runOnceAnimationsFinish:x,setDimensions:y,setMounted:C,setOpen:E,setVisible:I,transitionDimensionRef:_,visible:M,width:Q}=n,O=a.useRef(!1),W=a.useRef(null),T=a.useRef(f),L=a.useRef(f),H=os(),w=a.useMemo(()=>p.current==="css-animation"?!M:!f&&!A,[f,A,M,p]),J=Ee(i=>{if(!i)return;if(p.current==null||_.current==null){const d=getComputedStyle(i),b=d.animationName!=="none"&&d.animationName!=="",K=d.transitionDuration!=="0s"&&d.transitionDuration!=="";b&&K||(d.animationName==="none"&&d.transitionDuration!=="0s"?p.current="css-transition":d.animationName!=="none"&&d.transitionDuration==="0s"?p.current="css-animation":p.current="none"),i.getAttribute(js.orientation)==="horizontal"||d.transitionProperty.indexOf("width")>-1?_.current="width":_.current="height"}if(p.current!=="css-transition")return;(R===void 0||Q===void 0)&&(y({height:i.scrollHeight,width:i.scrollWidth}),L.current&&i.style.setProperty("transition-duration","0s"));let j=-1,g=-1;return j=B.request(()=>{L.current=!1,g=B.request(()=>{setTimeout(()=>{i.style.removeProperty("transition-duration")})})}),()=>{B.cancel(j),B.cancel(g)}}),z=ns(q,m,J);return G(()=>{if(p.current!=="css-transition")return;const i=m.current;if(!i)return;let j=-1;if(l.current!=null&&(l.current.abort(),l.current=null),f){const g={"justify-content":i.style.justifyContent,"align-items":i.style.alignItems,"align-content":i.style.alignContent,"justify-items":i.style.justifyItems};Object.keys(g).forEach(d=>{i.style.setProperty(d,"initial","important")}),!L.current&&!k&&i.setAttribute(de.startingStyle,""),y({height:i.scrollHeight,width:i.scrollWidth}),j=B.request(()=>{Object.entries(g).forEach(([d,b])=>{b===""?i.style.removeProperty(d):i.style.setProperty(d,b)})})}else{if(i.scrollHeight===0&&i.scrollWidth===0)return;y({height:i.scrollHeight,width:i.scrollWidth});const g=new AbortController;l.current=g;const d=g.signal;let b=null;const K=de.endingStyle;return b=new MutationObserver(Z=>{Z.some(ee=>ee.type==="attributes"&&ee.attributeName===K)&&(b?.disconnect(),b=null,x(()=>{y({height:0,width:0}),i.style.removeProperty("content-visibility"),C(!1),l.current===g&&(l.current=null)},d))}),b.observe(i,{attributes:!0,attributeFilter:[K]}),()=>{b?.disconnect(),H.cancel(),l.current===g&&(g.abort(),l.current=null)}}return()=>{B.cancel(j)}},[l,p,H,P,k,A,f,m,x,y,C]),G(()=>{if(p.current!=="css-animation")return;const i=m.current;i&&(W.current=i.style.animationName||W.current,i.style.setProperty("animation-name","none"),y({height:i.scrollHeight,width:i.scrollWidth}),!T.current&&!O.current&&i.style.removeProperty("animation-name"),f?(l.current!=null&&(l.current.abort(),l.current=null),C(!0),I(!0)):(l.current=new AbortController,x(()=>{C(!1),I(!1),l.current=null},l.current.signal)))},[l,p,f,m,x,y,C,I,M]),ds(()=>{const i=B.request(()=>{T.current=!1});return()=>B.cancel(i)}),G(()=>{if(!P)return;const i=m.current;if(!i)return;let j=-1,g=-1;return f&&O.current&&(i.style.transitionDuration="0s",y({height:i.scrollHeight,width:i.scrollWidth}),j=B.request(()=>{O.current=!1,g=B.request(()=>{setTimeout(()=>{i.style.removeProperty("transition-duration")})})})),()=>{B.cancel(j),B.cancel(g)}},[P,f,m,y]),G(()=>{const i=m.current;i&&P&&w&&(i.setAttribute("hidden","until-found"),p.current==="css-transition"&&i.setAttribute(de.startingStyle,""))},[P,w,p,m]),a.useEffect(function(){const j=m.current;if(!j)return;function g(d){O.current=!0,E(!0),v(!0,mt(ts,d))}return j.addEventListener("beforematch",g),()=>{j.removeEventListener("beforematch",g)}},[v,m,E]),a.useMemo(()=>({props:{hidden:w,id:F,ref:z}}),[w,F,z])}const gt={...xs,...ht},ys=a.forwardRef(function(l,p){const{render:q,className:R,defaultOpen:P=!1,disabled:k=!1,onOpenChange:F,open:A,...v}=l,f=Ee(F),m=ms({open:A,defaultOpen:P,onOpenChange:f,disabled:k}),x=a.useMemo(()=>({open:m.open,disabled:m.disabled,transitionStatus:m.transitionStatus}),[m.open,m.disabled,m.transitionStatus]),y=a.useMemo(()=>({...m,onOpenChange:f,state:x}),[m,f,x]),C=ze("div",l,{state:x,ref:p,props:v,stateAttributesMapping:gt});return e.jsx(pt.Provider,{value:y,children:C})}),bs={...gs,...ht},Ns=a.forwardRef(function(l,p){const{panelId:q,open:R,handleTrigger:P,state:k,disabled:F}=ft(),{className:A,disabled:v=F,id:f,render:m,nativeButton:x=!0,...y}=l,{getButtonProps:C,buttonRef:E}=is({disabled:v,focusableWhenDisabled:!0,native:x}),I=a.useMemo(()=>({"aria-controls":R?q:void 0,"aria-expanded":R,disabled:v,onClick:P}),[q,v,R,P]);return ze("button",l,{state:k,ref:[p,E],props:[I,y,C],stateAttributesMapping:bs})});let dt=(function(n){return n.collapsiblePanelHeight="--collapsible-panel-height",n.collapsiblePanelWidth="--collapsible-panel-width",n})({});const Ss=a.forwardRef(function(l,p){const{className:q,hiddenUntilFound:R,keepMounted:P,render:k,id:F,...A}=l,{abortControllerRef:v,animationTypeRef:f,height:m,mounted:x,onOpenChange:y,open:C,panelId:E,panelRef:I,runOnceAnimationsFinish:_,setDimensions:M,setHiddenUntilFound:Q,setKeepMounted:O,setMounted:W,setPanelIdState:T,setOpen:L,setVisible:H,state:w,transitionDimensionRef:J,visible:z,width:i,transitionStatus:j}=ft(),g=R??!1,d=P??!1;G(()=>{if(F)return T(F),()=>{T(void 0)}},[F,T]),G(()=>{Q(g)},[Q,g]),G(()=>{O(d)},[O,d]);const{props:b}=vs({abortControllerRef:v,animationTypeRef:f,externalRef:p,height:m,hiddenUntilFound:g,id:E,keepMounted:d,mounted:x,onOpenChange:y,open:C,panelRef:I,runOnceAnimationsFinish:_,setDimensions:M,setMounted:W,setOpen:L,setVisible:H,transitionDimensionRef:J,visible:z,width:i});cs({open:C&&j==="idle",ref:I,onComplete(){C&&M({height:void 0,width:void 0})}});const K=a.useMemo(()=>({...w,transitionStatus:j}),[w,j]),Z=ze("div",l,{state:K,ref:[p,I],props:[b,{style:{[dt.collapsiblePanelHeight]:m===void 0?"auto":`${m}px`,[dt.collapsiblePanelWidth]:i===void 0?"auto":`${i}px`}},A],stateAttributesMapping:gt});return d||g||!d&&x?Z:null});function De({className:n,...l}){return e.jsx(ys,{"data-slot":"collapsible",className:Re("flex flex-col",n),...l})}function Ie({className:n,children:l,...p}){return e.jsxs(Ns,{"data-slot":"collapsible-trigger",className:Re("group flex items-center gap-2 text-sm font-medium transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 [&[data-panel-open]>svg]:rotate-90",n),...p,children:[e.jsx(S,{icon:qt,className:"size-3 shrink-0 -rotate-90 text-muted-foreground transition-transform duration-200"}),l]})}function Oe({className:n,children:l,...p}){return e.jsx(Ss,{"data-slot":"collapsible-panel",className:Re("h-[var(--collapsible-panel-height)] overflow-hidden text-sm transition-[height] duration-200 ease-out data-[ending-style]:h-0 data-[starting-style]:h-0",n),...p,children:l})}De.__docgenInfo={description:"",methods:[],displayName:"CollapsibleRoot"};Ie.__docgenInfo={description:"",methods:[],displayName:"CollapsibleTrigger"};Oe.__docgenInfo={description:"",methods:[],displayName:"CollapsiblePanel"};const $={movies:{label:"Movies",icon:Gt,description:"Movie collection with TMDB metadata",needsApiKey:!0},tv:{label:"TV Shows",icon:ut,description:"Series with seasons and episodes from TMDB",needsApiKey:!0},music:{label:"Music",icon:Vt,description:"Artist and album organization with MusicBrainz metadata"},books:{label:"Books",icon:Jt,description:"Ebook library with OpenLibrary metadata"}},Cs={en_US:"United States",en_GB:"United Kingdom",en_CA:"Canada",en_AU:"Australia",en_IN:"India",de_DE:"Germany",de_AT:"Austria",de_CH:"Switzerland",fr_FR:"France",fr_BE:"Belgium",es_ES:"Spain",es_MX:"Mexico",es_AR:"Argentina",it_IT:"Italy",nl_NL:"Netherlands",pt_BR:"Brazil",pt_PT:"Portugal",sv_SE:"Sweden",da_DK:"Denmark",nb_NO:"Norway",fi_FI:"Finland",pl_PL:"Poland",cs_CZ:"Czech Republic",hu_HU:"Hungary",ro_RO:"Romania",el_GR:"Greece",tr_TR:"Turkey",ja_JP:"Japan",ko_KR:"South Korea",zh_TW:"Taiwan",zh_HK:"Hong Kong",th_TH:"Thailand",en_NZ:"New Zealand",en_ZA:"South Africa"},ws={artistFolder:"Artist Folder Format",albumFolder:"Album Folder Format",trackFile:"Track File Format",movieFolder:"Movie Folder Format",movieFile:"Movie File Format",showFolder:"Show Folder Format",seasonFolder:"Season Folder Format",episodeFile:"Episode File Format",authorFolder:"Author Folder Format",bookFile:"Book File Format"},ct={movies:[{id:1,name:"Bluray 2160p"},{id:2,name:"Bluray 1080p"},{id:3,name:"Bluray 720p"},{id:4,name:"Web 2160p"},{id:5,name:"Web 1080p"},{id:6,name:"Web 720p"},{id:7,name:"HDTV 1080p"},{id:8,name:"HDTV 720p"},{id:9,name:"DVD"}],tv:[{id:1,name:"Bluray 2160p"},{id:2,name:"Bluray 1080p"},{id:3,name:"Bluray 720p"},{id:4,name:"Web 2160p"},{id:5,name:"Web 1080p"},{id:6,name:"Web 720p"},{id:7,name:"HDTV 1080p"},{id:8,name:"HDTV 720p"},{id:9,name:"DVD"}],music:[{id:1,name:"FLAC"},{id:2,name:"ALAC"},{id:3,name:"WAV"},{id:4,name:"MP3 320"},{id:5,name:"MP3 V0"},{id:6,name:"MP3 256"},{id:7,name:"MP3 192"},{id:8,name:"AAC 256"},{id:9,name:"OGG Vorbis"}],books:[{id:1,name:"EPUB"},{id:2,name:"PDF"},{id:3,name:"MOBI"},{id:4,name:"AZW3"},{id:5,name:"CBZ"},{id:6,name:"CBR"}]};function ks(){const[n,l]=a.useState({enabledMediaTypes:["movies"],hasTmdbApiKey:!1,hasTraktClientId:!1,recommendationSettings:{traktEnabled:!1,personalizedEnabled:!1,maxPersonalizedLanes:3,justwatchEnabled:!1},justwatchEnabled:!1,justwatchLocale:"en_US",selectedStreamingProviders:[]}),[p,q]=a.useState([]),[R,P]=a.useState(!0),[k,F]=a.useState([]),[A,v]=a.useState(!1),[f,m]=a.useState(null),[x,y]=a.useState({}),[C,E]=a.useState({}),[I,_]=a.useState(!1),[M,Q]=a.useState("music"),[O,W]=a.useState(null),[T,L]=a.useState(""),[H,w]=a.useState(""),[J,z]=a.useState(!1),[i,j]=a.useState(!1),[g,d]=a.useState(!1),[b,K]=a.useState(""),[Z,Se]=a.useState(!1),[ee,Ke]=a.useState(!1),[xt,ce]=a.useState(!1),[ue,Be]=a.useState(""),[Ce,jt]=a.useState(!1),[Le,He]=a.useState(!1),[vt,me]=a.useState([]),[yt,he]=a.useState(!1),[Y,Ue]=a.useState(null),[we,bt]=a.useState("music"),[pe,ke]=a.useState(""),[fe,Pe]=a.useState([]),[qe,Fe]=a.useState(!0),[$e,Qe]=a.useState(!1),[Nt,ge]=a.useState(!1),[xe,Ae]=a.useState(null),[We,Je]=a.useState(!1),U=async()=>{try{const[t,s,r,h]=await Promise.all([fetch("/api/v1/settings"),fetch("/api/v1/rootfolders"),fetch("/api/v1/settings/naming-patterns"),fetch("/api/v1/qualityprofiles")]);if(t.ok){const u=await t.json();l(D=>({...D,...u,recommendationSettings:u.recommendationSettings??D.recommendationSettings}))}if(s.ok){const u=await s.json();q(u)}if(r.ok){const u=await r.json();m(u),y(JSON.parse(JSON.stringify(u.patterns)))}if(h.ok){const u=await h.json();me(u)}}catch{c.error("Failed to load settings")}finally{P(!1)}},St=async()=>{v(!0);try{const t=await fetch("/api/v1/settings/watch-providers");if(t.ok){const s=await t.json();F(s.providers||[])}}catch{}finally{v(!1)}};a.useEffect(()=>{U()},[]),a.useEffect(()=>{n.hasTmdbApiKey&&St()},[n.hasTmdbApiKey]);const Ct=async t=>{const s=n.selectedStreamingProviders,r=s.includes(t)?s.filter(h=>h!==t):[...s,t];l(h=>({...h,selectedStreamingProviders:r}));try{(await fetch("/api/v1/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({selectedStreamingProviders:r})})).ok||(c.error("Failed to save streaming providers"),U())}catch{c.error("Failed to save streaming providers"),U()}},wt=async(t,s)=>{if(s&&$[t].needsApiKey&&!n.hasTmdbApiKey){c.error(`Please configure your TMDB API key first to enable ${$[t].label}`),d(!0);return}try{const r=await fetch("/api/v1/settings/media-type",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mediaType:t,enabled:s})});if(r.ok){const h=await r.json();l(u=>({...u,enabledMediaTypes:h.enabledMediaTypes})),c.success(`${$[t].label} ${s?"enabled":"disabled"}`)}else c.error("Failed to update media type")}catch{c.error("Failed to update media type")}},Ve=t=>p.find(s=>s.mediaType===t),Ge=t=>{const s=Ve(t);Q(t),W(s?.id||null),L(s?.path||""),w(s?.name||""),z(!1),_(!0)},kt=async()=>{if(!T.trim()){c.error("Path is required");return}j(!0);try{if(O){const t=await fetch(`/api/v1/rootfolders/${O}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:T,name:H||void 0,mediaType:M})});if(t.ok)c.success("Folder updated"),_(!1),U();else{const s=await t.json();c.error(s.error||"Failed to update folder")}}else{const t=await fetch("/api/v1/rootfolders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:T,name:H||void 0,mediaType:M,createIfMissing:J})});if(t.ok)c.success("Folder added"),_(!1),U();else{const s=await t.json();c.error(s.error||"Failed to add folder")}}}catch{c.error("Failed to save folder")}finally{j(!1)}},Pt=async()=>{if(!b.trim()){c.error("API key is required");return}Ke(!0);try{const t=await fetch("/api/v1/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({tmdbApiKey:b})});if(t.ok){const s=await t.json();l(r=>({...r,hasTmdbApiKey:s.hasTmdbApiKey})),c.success("TMDB API key saved"),d(!1),K("")}else c.error("Failed to save API key")}catch{c.error("Failed to save API key")}finally{Ke(!1)}},Ft=async()=>{if(!ue.trim()){c.error("Client ID is required");return}He(!0);try{const t=await fetch("/api/v1/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({traktClientId:ue})});if(t.ok){const s=await t.json();l(r=>({...r,hasTraktClientId:s.hasTraktClientId})),c.success("Trakt client ID saved"),ce(!1),Be("")}else c.error("Failed to save Trakt client ID")}catch{c.error("Failed to save Trakt client ID")}finally{He(!1)}},Te=async t=>{l(s=>({...s,recommendationSettings:t}));try{(await fetch("/api/v1/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({recommendationSettings:t})})).ok||(c.error("Failed to save recommendation settings"),U())}catch{c.error("Failed to save recommendation settings"),U()}},At=async t=>{const s={...n.recommendationSettings,justwatchEnabled:t};l(r=>({...r,justwatchEnabled:t,recommendationSettings:s}));try{(await fetch("/api/v1/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({justwatchEnabled:t,recommendationSettings:s})})).ok||(c.error("Failed to save settings"),U())}catch{c.error("Failed to save settings"),U()}},Tt=async t=>{l(s=>({...s,justwatchLocale:t}));try{(await fetch("/api/v1/settings",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({justwatchLocale:t})})).ok||(c.error("Failed to save locale"),U())}catch{c.error("Failed to save locale"),U()}},Ze=(t,s,r)=>{y(h=>({...h,[t]:{...h[t],[s]:r}}))},_t=t=>{if(!f||!x[t])return!1;const s=f.patterns[t],r=x[t];return Object.keys(s).some(h=>s[h]!==r[h])},Mt=async t=>{if(x[t]){E(s=>({...s,[t]:!0}));try{const s=await fetch("/api/v1/settings/naming-patterns",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({mediaType:t,patterns:x[t]})});if(s.ok){const r=await s.json();m(h=>h?{...h,patterns:{...h.patterns,[t]:r.patterns},examples:{...h.examples,[t]:r.examples}}:null),c.success(`${$[t].label} naming patterns saved`)}else{const r=await s.json();c.error(r.error||"Failed to save patterns")}}catch{c.error("Failed to save patterns")}finally{E(s=>({...s,[t]:!1}))}}},Dt=(t,s,r)=>{if(!f)return"";const h=f.variables[t]?.[s]||[];let u=r;for(const D of h)u=u.replace(new RegExp(`\\{${D.name}\\}`,"g"),D.example);return u.replace(/\s*\(\s*\)/g,"").replace(/\s*\[\s*\]/g,"").replace(/\s+/g," ").trim()},Ye=(t,s)=>{bt(t),s?(Ue(s),ke(s.name),Pe(s.items),Fe(s.upgradeAllowed)):(Ue(null),ke(""),Pe(ct[t].map(r=>({...r,allowed:!0}))),Fe(!0)),he(!0)},It=async()=>{if(!pe.trim()){c.error("Profile name is required");return}Qe(!0);try{const t=Y?`/api/v1/qualityprofiles/${Y.id}`:"/api/v1/qualityprofiles",s=await fetch(t,{method:Y?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:pe,mediaType:we,items:fe,upgradeAllowed:qe,cutoff:fe.find(r=>r.allowed)?.id||1})});if(s.ok){const r=await s.json();me(Y?h=>h.map(u=>u.id===r.id?r:u):h=>[...h,r]),c.success(`Quality profile ${Y?"updated":"created"}`),he(!1)}else{const r=await s.json();c.error(r.error||"Failed to save profile")}}catch{c.error("Failed to save profile")}finally{Qe(!1)}},Ot=t=>{Ae(t),ge(!0)},Rt=async()=>{if(xe){Je(!0);try{(await fetch(`/api/v1/qualityprofiles/${xe.id}`,{method:"DELETE"})).ok?(me(s=>s.filter(r=>r.id!==xe.id)),c.success("Quality profile deleted"),ge(!1),Ae(null)):c.error("Failed to delete profile")}catch{c.error("Failed to delete profile")}finally{Je(!1)}}},Et=t=>{Pe(s=>s.map(r=>r.id===t?{...r,allowed:!r.allowed}:r))},Xe=t=>vt.filter(s=>s.mediaType===t);return e.jsxs(Ht,{title:"Media Management",children:[e.jsx(Kt,{title:"Media Management"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs(je,{children:[e.jsxs(ve,{children:[e.jsx(ye,{children:"API Keys"}),e.jsx(be,{children:"Configure API keys for metadata providers"})]}),e.jsx(Ne,{children:e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:e.jsx(S,{icon:$t,className:"size-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"TMDB API Key"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Required for Movies and TV Shows metadata."," ",e.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Get one free"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[n.hasTmdbApiKey?e.jsxs("span",{className:"text-sm text-green-600 flex items-center gap-1",children:[e.jsx(S,{icon:_e,className:"size-4"}),"Configured"]}):e.jsxs("span",{className:"text-sm text-orange-500 flex items-center gap-1",children:[e.jsx(S,{icon:Me,className:"size-4"}),"Not configured"]}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>d(!0),children:n.hasTmdbApiKey?"Change":"Add"})]})]})})]}),e.jsxs(je,{children:[e.jsxs(ve,{children:[e.jsx(ye,{children:"Recommendations"}),e.jsx(be,{children:"Configure recommendation sources for the search page discover lanes"})]}),e.jsxs(Ne,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:e.jsx(S,{icon:Qt,className:"size-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Trakt.tv"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Community-powered trending, anticipated, and recommended lists."," ",e.jsx("a",{href:"https://trakt.tv/oauth/applications",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"Get a free client ID"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[n.hasTraktClientId?e.jsxs("span",{className:"text-sm text-green-600 flex items-center gap-1",children:[e.jsx(S,{icon:_e,className:"size-4"}),"Configured"]}):e.jsxs("span",{className:"text-sm text-orange-500 flex items-center gap-1",children:[e.jsx(S,{icon:Me,className:"size-4"}),"Not configured"]}),e.jsx(oe,{checked:n.recommendationSettings.traktEnabled,onCheckedChange:t=>Te({...n.recommendationSettings,traktEnabled:t}),disabled:!n.hasTraktClientId}),e.jsx(N,{variant:"outline",size:"sm",onClick:()=>ce(!0),children:n.hasTraktClientId?"Change":"Set Client ID"})]})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:e.jsx(S,{icon:ut,className:"size-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"JustWatch"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Show streaming availability and popular streaming content."})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[n.justwatchEnabled&&e.jsxs(tt,{value:n.justwatchLocale,onValueChange:t=>Tt(t),children:[e.jsx(st,{className:"w-36",children:e.jsx("span",{className:"truncate",children:Cs[n.justwatchLocale]||n.justwatchLocale})}),e.jsxs(nt,{children:[e.jsx(o,{value:"en_US",children:"United States"}),e.jsx(o,{value:"en_GB",children:"United Kingdom"}),e.jsx(o,{value:"en_CA",children:"Canada"}),e.jsx(o,{value:"en_AU",children:"Australia"}),e.jsx(o,{value:"en_IN",children:"India"}),e.jsx(o,{value:"de_DE",children:"Germany"}),e.jsx(o,{value:"de_AT",children:"Austria"}),e.jsx(o,{value:"de_CH",children:"Switzerland"}),e.jsx(o,{value:"fr_FR",children:"France"}),e.jsx(o,{value:"fr_BE",children:"Belgium"}),e.jsx(o,{value:"es_ES",children:"Spain"}),e.jsx(o,{value:"es_MX",children:"Mexico"}),e.jsx(o,{value:"es_AR",children:"Argentina"}),e.jsx(o,{value:"it_IT",children:"Italy"}),e.jsx(o,{value:"nl_NL",children:"Netherlands"}),e.jsx(o,{value:"pt_BR",children:"Brazil"}),e.jsx(o,{value:"pt_PT",children:"Portugal"}),e.jsx(o,{value:"sv_SE",children:"Sweden"}),e.jsx(o,{value:"da_DK",children:"Denmark"}),e.jsx(o,{value:"nb_NO",children:"Norway"}),e.jsx(o,{value:"fi_FI",children:"Finland"}),e.jsx(o,{value:"pl_PL",children:"Poland"}),e.jsx(o,{value:"cs_CZ",children:"Czech Republic"}),e.jsx(o,{value:"hu_HU",children:"Hungary"}),e.jsx(o,{value:"ro_RO",children:"Romania"}),e.jsx(o,{value:"el_GR",children:"Greece"}),e.jsx(o,{value:"tr_TR",children:"Turkey"}),e.jsx(o,{value:"ja_JP",children:"Japan"}),e.jsx(o,{value:"ko_KR",children:"South Korea"}),e.jsx(o,{value:"zh_TW",children:"Taiwan"}),e.jsx(o,{value:"zh_HK",children:"Hong Kong"}),e.jsx(o,{value:"th_TH",children:"Thailand"}),e.jsx(o,{value:"en_NZ",children:"New Zealand"}),e.jsx(o,{value:"en_ZA",children:"South Africa"})]})]}),e.jsx(oe,{checked:n.justwatchEnabled,onCheckedChange:At})]})]}),e.jsxs("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex h-10 w-10 items-center justify-center rounded-lg bg-muted",children:e.jsx(S,{icon:Wt,className:"size-5 text-muted-foreground"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Personalized Recommendations"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:'"Because you have..." lanes based on your library. Uses TMDB recommendations API.'})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[n.recommendationSettings.personalizedEnabled&&e.jsxs(tt,{value:n.recommendationSettings.maxPersonalizedLanes.toString(),onValueChange:t=>Te({...n.recommendationSettings,maxPersonalizedLanes:Number.parseInt(t,10)}),children:[e.jsx(st,{className:"w-24",children:e.jsx(Bt,{})}),e.jsxs(nt,{children:[e.jsx(o,{value:"1",children:"1 lane"}),e.jsx(o,{value:"2",children:"2 lanes"}),e.jsx(o,{value:"3",children:"3 lanes"}),e.jsx(o,{value:"5",children:"5 lanes"})]})]}),e.jsx(oe,{checked:n.recommendationSettings.personalizedEnabled,onCheckedChange:t=>Te({...n.recommendationSettings,personalizedEnabled:t})})]})]})]})]}),n.hasTmdbApiKey&&e.jsxs(je,{children:[e.jsxs(ve,{children:[e.jsx(ye,{children:"Streaming Services"}),e.jsx(be,{children:"Select your streaming subscriptions to see availability badges on teasers"})]}),e.jsxs(Ne,{children:[A?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:Array.from({length:8}).map((t,s)=>e.jsx("div",{className:"h-12 rounded-lg bg-muted animate-pulse"},s))}):k.length>0?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:k.map(t=>{const s=n.selectedStreamingProviders.includes(t.id);return e.jsxs("button",{type:"button",onClick:()=>Ct(t.id),className:`flex items-center gap-3 rounded-lg border p-3 transition-all text-left ${s?"border-primary bg-primary/5 ring-1 ring-primary/30":"border-border hover:border-muted-foreground/30"}`,children:[e.jsx("img",{src:t.logoPath,alt:t.name,className:"h-8 w-8 rounded-md flex-shrink-0"}),e.jsx("span",{className:"text-sm font-medium truncate",children:t.name})]},t.id)})}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"No providers available. Make sure a locale is configured above."}),n.selectedStreamingProviders.length>0&&e.jsxs("p",{className:"text-sm text-muted-foreground mt-3",children:[n.selectedStreamingProviders.length," service",n.selectedStreamingProviders.length!==1?"s":""," selected"]})]})]}),e.jsxs(je,{children:[e.jsxs(ve,{children:[e.jsx(ye,{children:"Media Types"}),e.jsx(be,{children:"Enable media types and configure their library folders"})]}),e.jsx(Ne,{className:"space-y-4",children:Object.keys($).map(t=>{const s=$[t],r=n.enabledMediaTypes.includes(t),h=Ve(t);return e.jsxs("div",{className:`rounded-lg border ${r?"border-primary/50":""}`,children:[e.jsxs("div",{className:`flex items-center justify-between p-4 ${r?"bg-primary/5":""}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-lg ${r?"bg-primary/10 text-primary":"bg-muted text-muted-foreground"}`,children:e.jsx(S,{icon:s.icon,className:"size-5"})}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:s.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.description})]})]}),e.jsx(oe,{checked:r,onCheckedChange:u=>wt(t,u)})]}),r&&e.jsxs("div",{className:"border-t bg-muted/30",children:[e.jsxs("div",{className:"flex items-center justify-between p-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(S,{icon:Zt,className:"size-4 text-muted-foreground"}),e.jsx("span",{className:"text-sm font-medium",children:"Library Folder"})]}),h?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded",children:h.path}),h.accessible?e.jsx(S,{icon:_e,className:"size-4 text-green-600"}):e.jsx(S,{icon:Me,className:"size-4 text-destructive"}),e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>Ge(t),children:e.jsx(S,{icon:at,className:"size-4"})})]}):e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>Ge(t),children:[e.jsx(S,{icon:it,className:"size-4 mr-1"}),"Set Folder"]})]}),e.jsxs(De,{className:"border-t",children:[e.jsx("div",{className:"p-4",children:e.jsx(Ie,{className:"text-muted-foreground hover:text-foreground",children:"File Organization"})}),e.jsx(Oe,{children:e.jsxs("div",{className:"space-y-4 px-4 pb-4",children:[f&&x[t]&&Object.entries(x[t]).map(([u,D])=>{const zt=f.variables[t]?.[u]||[],et=Dt(t,u,D);return e.jsxs("div",{className:"space-y-1.5",children:[e.jsx(V,{className:"text-xs text-muted-foreground",children:ws[u]||u}),e.jsx(le,{value:D,onChange:X=>Ze(t,u,X.target.value),className:"h-8 text-sm font-mono"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:zt.map(X=>e.jsx("button",{type:"button",onClick:()=>Ze(t,u,D+`{${X.name}}`),className:"text-xs px-1.5 py-0.5 rounded bg-muted hover:bg-muted/80 text-muted-foreground font-mono",title:X.description,children:`{${X.name}}`},X.name))}),et&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Example: ",et]})]},u)}),_t(t)&&e.jsx(N,{size:"sm",onClick:()=>Mt(t),disabled:C[t],children:C[t]?"Saving...":"Save Changes"})]})})]}),e.jsxs(De,{className:"border-t",children:[e.jsx("div",{className:"p-4",children:e.jsx(Ie,{className:"text-muted-foreground hover:text-foreground",children:"Quality Profiles"})}),e.jsx(Oe,{children:e.jsxs("div",{className:"space-y-3 px-4 pb-4",children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Define which quality levels are acceptable for downloads."}),Xe(t).length>0?e.jsx("div",{className:"space-y-2",children:Xe(t).map(u=>e.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:u.name}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:u.items.filter(D=>D.allowed).map(D=>e.jsx(Ut,{variant:"secondary",className:"text-xs",children:D.name},D.id))})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>Ye(t,u),children:e.jsx(S,{icon:at,className:"size-4"})}),e.jsx(N,{variant:"ghost",size:"sm",onClick:()=>Ot(u),children:e.jsx(S,{icon:Yt,className:"size-4 text-destructive"})})]})]},u.id))}):e.jsx("p",{className:"text-sm text-muted-foreground italic",children:"No quality profiles configured."}),e.jsxs(N,{variant:"outline",size:"sm",onClick:()=>Ye(t),children:[e.jsx(S,{icon:it,className:"size-4 mr-1"}),"Add Profile"]})]})})]})]})]},t)})})]})]}),e.jsx(te,{open:I,onOpenChange:_,children:e.jsxs(se,{className:"max-w-2xl",children:[e.jsxs(ne,{children:[e.jsxs(ae,{children:[O?"Edit":"Set"," ",$[M].label," Folder"]}),e.jsxs(ie,{children:["Select a folder where your ",$[M].label.toLowerCase()," files are stored."]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsx(us,{value:T,onChange:L,createIfMissing:J,onCreateIfMissingChange:z}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"name",children:"Name (optional)"}),e.jsx(le,{id:"name",placeholder:`My ${$[M].label} Library`,value:H,onChange:t=>w(t.target.value)})]})]}),e.jsxs(re,{children:[e.jsx(N,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),e.jsx(N,{onClick:kt,disabled:i||!T,children:i?"Saving...":"Save"})]})]})}),e.jsx(te,{open:g,onOpenChange:d,children:e.jsxs(se,{children:[e.jsxs(ne,{children:[e.jsx(ae,{children:"TMDB API Key"}),e.jsxs(ie,{children:["Enter your TMDB API key to enable Movies and TV Shows metadata. You can get a free API key at"," ",e.jsx("a",{href:"https://www.themoviedb.org/settings/api",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"themoviedb.org"})]})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"apiKey",children:"API Key (v3 auth)"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{id:"apiKey",type:Z?"text":"password",placeholder:"Enter your TMDB API key",value:b,onChange:t=>K(t.target.value),className:"pr-10"}),e.jsx(N,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>Se(!Z),children:e.jsx(S,{icon:Z?rt:lt,className:"size-4"})})]})]})}),e.jsxs(re,{children:[e.jsx(N,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),e.jsx(N,{onClick:Pt,disabled:ee||!b.trim(),children:ee?"Saving...":"Save"})]})]})}),e.jsx(te,{open:xt,onOpenChange:ce,children:e.jsxs(se,{children:[e.jsxs(ne,{children:[e.jsx(ae,{children:"Trakt Client ID"}),e.jsxs(ie,{children:["Enter your Trakt client ID to enable community-powered recommendations. You can get a free client ID at"," ",e.jsx("a",{href:"https://trakt.tv/oauth/applications",target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:"trakt.tv"})]})]}),e.jsx("div",{className:"space-y-4 py-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"traktClientId",children:"Client ID"}),e.jsxs("div",{className:"relative",children:[e.jsx(le,{id:"traktClientId",type:Ce?"text":"password",placeholder:"Enter your Trakt client ID",value:ue,onChange:t=>Be(t.target.value),className:"pr-10"}),e.jsx(N,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3",onClick:()=>jt(!Ce),children:e.jsx(S,{icon:Ce?rt:lt,className:"size-4"})})]})]})}),e.jsxs(re,{children:[e.jsx(N,{variant:"outline",onClick:()=>ce(!1),children:"Cancel"}),e.jsx(N,{onClick:Ft,disabled:Le||!ue.trim(),children:Le?"Saving...":"Save"})]})]})}),e.jsx(te,{open:yt,onOpenChange:he,children:e.jsxs(se,{children:[e.jsxs(ne,{children:[e.jsxs(ae,{children:[Y?"Edit":"Add"," Quality Profile"]}),e.jsxs(ie,{children:["Define which quality levels are acceptable for"," ",$[we].label.toLowerCase()," downloads."]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{htmlFor:"qualityName",children:"Profile Name"}),e.jsx(le,{id:"qualityName",placeholder:"e.g., High Quality",value:pe,onChange:t=>ke(t.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Allowed Qualities"}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:ct[we].map(t=>{const s=fe.find(r=>r.id===t.id);return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Lt,{id:`quality-${t.id}`,checked:s?.allowed??!1,onCheckedChange:()=>Et(t.id)}),e.jsx(V,{htmlFor:`quality-${t.id}`,className:"font-normal cursor-pointer text-sm",children:t.name})]},t.id)})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{id:"upgradeAllowed",checked:qe,onCheckedChange:Fe}),e.jsx(V,{htmlFor:"upgradeAllowed",className:"font-normal cursor-pointer",children:"Upgrade existing files when better quality is available"})]})]}),e.jsxs(re,{children:[e.jsx(N,{variant:"outline",onClick:()=>he(!1),children:"Cancel"}),e.jsx(N,{onClick:It,disabled:$e||!pe.trim()||!fe.some(t=>t.allowed),children:$e?"Saving...":Y?"Save":"Add"})]})]})}),e.jsx(te,{open:Nt,onOpenChange:ge,children:e.jsxs(se,{children:[e.jsxs(ne,{children:[e.jsx(ae,{children:"Delete Profile"}),e.jsxs(ie,{children:['Are you sure you want to delete the quality profile "',xe?.name,'"? This action cannot be undone.']})]}),e.jsxs(re,{children:[e.jsx(N,{variant:"outline",onClick:()=>{ge(!1),Ae(null)},children:"Cancel"}),e.jsx(N,{variant:"destructive",onClick:Rt,disabled:We,children:We?"Deleting...":"Delete"})]})]})})]})}ks.__docgenInfo={description:"",methods:[],displayName:"MediaManagement"};export{ks as default};
